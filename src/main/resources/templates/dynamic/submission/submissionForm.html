<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Welcome to EasyChair</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen font-sans">
<!--Insertion de la navbar-->
<div th:replace="sidebar/sidebar::sideBar"></div>

<div class="relative flex justify-center mt-10">
    <!-- Chevron gauche tr√®s rapproch√© -->
    <div class="absolute left-10 top-0 mt-2">
        <button class="w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 shadow flex items-center justify-center text-xl text-gray-600">
            <a th:href="@{/conference}"><</a>
        </button>
    </div>
    <div class="bg-white rounded-lg shadow-md p-6 w-full max-w-2xl">
        <!-- Formulaire -->
            <form th:object="${submission}"
                  th:action="@{${submission.id == null ? '/submissions/save' : '/submissions/update'}}"
                  method="post">

                <input type="hidden" th:field="*{authors[0].id}" />
                <input type="hidden" th:field="*{conference.id}" />

                <!-- Champ ID cach√© pour l'√©dition -->
                <input type="hidden" th:field="*{id}" th:if="${submission.id != null}" />

                <div class="bg-gray-100 rounded-2xl shadow-md p-8 w-full max-w-4xl border border-gray-300">
                    <h2 class="text-xl font-bold text-center mb-6"
                        th:text="${submission.id == null} ? 'Creating Submission' : 'Updating Submission'">
                    </h2>
                <!-- Titre -->
                <div class="mb-4">
                    <label class="block font-semibold mb-1">Title :</label>
                    <input type="text" th:field="*{title}" th:readonly="${submission.id != null}" class="w-full border border-gray-300 rounded-md px-4 py-2 bg-white" />
                </div>

                <div class="mb-4 flex space-x-6" th:unless="${submission.id==null}">
                    <!-- date de cr√©ation (uniquement afficher si non null) -->
                    <div class="flex-1">
                        <label class="block font-semibold mb-1 text-gray-800">Date de cr√©ation :</label>
                        <p class="px-4 py-2 border border-gray-300 rounded-md text-black font-medium">
                            <span th:text="${submission.creationDate}"></span>
                        </p>
                    </div>


                <!-- statut (uniquement afficher si non null) -->
                    <div class="flex-1">
                        <label class="block font-semibold mb-1 text-gray-800">Statut :</label>
                        <p class="px-4 py-2 border border-gray-300 rounded-md text-black font-medium">
                            <span th:text="${submission.status}"></span>
                        </p>
                    </div>
                </div>



                <!-- TODO: Keywords -->
                <div class="space-y-4">
                    <div class="mb-4">
                        <label class="block font-semibold mb-1">Keywords :</label>
                        <!-- Conteneur flexible et fluide -->
                        <div class="flex flex-wrap items-center gap-2 mb-2">

                            <!-- Champ de texte avec largeur r√©duite -->
                            <input type="text" class="w-48 border border-gray-300 rounded-md px-4 py-2 bg-white" placeholder="Add keyword..."/>

                            <!-- Bouton avec taille constante et espac√©e -->
                            <button class="shrink-0 bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-full shadow">Add Keyword</button>
                        </div>

                        <!-- Liste des mots-cl√©s -->
                        <div id="keywords-container" class="space-y-1">

                        </div>

                        <input type="hidden" name="keywordList" id="keywordList" />
                    </div>

                <!-- Abstract -->
                <!-- Champ editable si non verrouill√© -->
                <div class="mb-6" th:unless="${submission.conference.phase!=T(fr.upsaclay.easychair.model.enumates.Phase).ABSTRACT_SUBMISSION}">
                    <label for="abstract" class="block font-semibold mb-1 text-gray-800">Abstract (max 200 characters) :</label>
                    <textarea id="abstract"
                              name="abstract"
                              th:field="*{abstractSub}"
                              maxlength="300"
                              rows="5"
                              class="w-full border border-gray-300 rounded-md px-4 py-2 bg-white text-gray-800 resize-none focus:outline-none focus:ring-2 focus:ring-blue-200"></textarea>
                </div>

                <!-- Champ en lecture seule si verrouill√© -->
                <!-- pas writing si pas abstractPhase -->
                <div class="mb-6" th:if="${submission.conference.phase!=T(fr.upsaclay.easychair.model.enumates.Phase).ABSTRACT_SUBMISSION}">
                    <label class="block font-semibold mb-1 text-gray-800">Abstract :</label>
                    <p class="px-4 py-2 border border-gray-300 rounded-md text-black font-medium whitespace-pre-wrap">
                        <span th:text="${submission.abstractSub}"></span>
                    </p>
                </div>



                <!-- Ajout de fichier -->
                <!-- gris√© si pas bonne phase -->

                <div class="flex items-center space-x-3 mb-6">
                    <button
                            class="bg-gray-200 text-gray-700 px-4 py-2 rounded-full shadow
                   hover:bg-gray-300
                   disabled:bg-gray-300 disabled:text-gray-400 disabled:cursor-not-allowed hover:disabled:bg-gray-300
                   disabled:opacity-50 transition disabled:transition-none"
                            th:disabled="${submission.conference.phase != T(fr.upsaclay.easychair.model.enumates.Phase).CONCRETE_SUBMISSION
                          and submission.conference.phase != T(fr.upsaclay.easychair.model.enumates.Phase).FINAL_SUBMISSION}">
                        Add a file
                    </button>

                    <input type="text" placeholder="No file selected"
                           class="flex-1 border border-gray-300 rounded-md px-4 py-2 bg-white" />
                </div>

                <!-- Soumission -->
                <div class="text-center">
                    <button
                            class="bg-blue-300 hover:bg-blue-400 text-white px-6 py-2 rounded-full font-semibold transition"
                            th:text="${submission.id == null} ? 'Add submission' : 'Update submission'">
                    </button>
                </div>
            </div>

        </form>
    </div>
</div>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const addButton = Array.from(document.querySelectorAll("button")).find(btn => btn.textContent.trim() === "Add Keyword");
        const keywordInput = document.querySelector("input[placeholder='Add keyword...']");
        const keywordListInput = document.getElementById("keywordList");
        const keywordsContainer = document.getElementById("keywords-container");

        let keywords = [];

        function updateKeywordInput() {
            keywordListInput.value = keywords.join(",");
        }

        addButton?.addEventListener("click", (e) => {
            e.preventDefault();
            const keyword = keywordInput.value.trim();
            if (!keyword || keywords.includes(keyword)) return;

            keywords.push(keyword);
            updateKeywordInput();

            const keywordItem = document.createElement("div");
            keywordItem.className = "flex items-center space-x-2";

            const keywordText = document.createElement("span");
            keywordText.textContent = keyword;

            const deleteButton = document.createElement("button");
            deleteButton.textContent = "üóëÔ∏è";
            deleteButton.className = "text-red-600 hover:text-red-800 text-lg";
            deleteButton.addEventListener("click", () => {
                keywords = keywords.filter(k => k !== keyword);
                updateKeywordInput();
                keywordItem.remove();
            });

            keywordItem.appendChild(keywordText);
            keywordItem.appendChild(deleteButton);
            keywordsContainer.appendChild(keywordItem);

            keywordInput.value = "";
        });
    });
</script>

</body>
</html>
